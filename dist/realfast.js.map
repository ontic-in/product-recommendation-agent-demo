{"version":3,"file":"realfast.js","names":["MESSAGES","text","position","delay","id","AGENT_ID","AGENT_NAME","AGENT_URL","injectStyles","style","document","createElement","textContent","head","appendChild","setIPAddress","window","fetch","then","response","ok","Error","concat","status","json","data","ip","embeddedservice_bootstrap","prechatAPI","setHiddenPrechatFields","ip_address","catch","error","console","warn","message","getUTMParam","param","urlParams","URLSearchParams","location","search","get","trackEvent","eventName","clarity","hideMessages","container","querySelector","display","openChat","chatButton","click","addMessage","classes","messageElement","className","addEventListener","showMessages","body","closeButton","innerHTML","onclick","e","preventDefault","stopPropagation","forEach","index","setTimeout","initMessagePrompts","attempts","arguments","length","undefined","log","initEmbeddedMessaging","settings","language","utm_source","utm_campaign","utm_content","utm_term","utm_medium","init","scrt2URL","widgetStorage","localStorage","getItem","widgetData","JSON","parse","CONVERSATION_BUTTON_CLICK_TIME","err"],"sources":["../src/realfast.js"],"sourcesContent":["\"use strict\";\n\n/**\n * Houzi AI Real Estate Assistant\n * Embeds a chat widget with floating message prompts\n */\n\n// Configuration\nconst MESSAGES = [\n  {\n    text: \"Hi there! ðŸ‘‹\" + \n          \"Looking for something perfect? I'm here to help you find the best products based on your preferences, needs, and budget. Just tell me what you're looking for, and Iâ€™ll take care of the rest!\",\n    position: \"left\",\n    delay: 500,\n    id: \"intro-msg\",\n  },\n  {\n    text: \"Can you recommend me some sofa sets?\",\n    position: \"right\",\n    delay: 1000,\n    id: \"rec-sofa-sets-question\",\n  },\n  {\n    text: \"Can you find a sofa with storage?\",\n    position: \"right\",\n    delay: 2000,\n    id: \"rec-sofa-sets-with-storage-question\",\n  },\n];\n\nconst AGENT_ID = \"00D7x00000EuqtW\";\nconst AGENT_NAME = \"Product_Recommendation_Agent_ESD\";\nconst AGENT_URL =\n  \"https://realfast-ai--sandboxjtb.sandbox.my.site.com/ESWProductRecommendation1743574996532\";\n\n// Create and inject CSS styles\nfunction injectStyles() {\n  const style = document.createElement(\"style\");\n  style.textContent = `\n    .floating-message-container {\n      position: fixed;\n      bottom: 100px;\n      right: 20px;\n      width: auto;\n      font-family: Arial, sans-serif;\n      display: flex;\n      flex-direction: column;\n      align-items: flex-end;\n      gap: 10px;\n      z-index: 999999;\n    }\n    \n    .floating-message {\n      max-width: 360px;\n      padding: 15px 20px;\n      border-radius: 18px;\n      box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);\n      animation: fadeIn 0.5s ease-out;\n      position: relative;\n      background: white;\n      color: #333;\n      transition: all 0.3s ease;\n      cursor: pointer;\n    }\n    \n    .clickable {\n      border-radius: 100px;\n      color: #3277e6;\n    }\n\n    .floating-message:hover {\n      opacity: 0.9;\n    }\n    \n    .floating-chat-icon {\n      position: fixed;\n      bottom: 20px;\n      right: 20px;\n      width: 60px;\n      height: 60px;\n      background: #28323c;\n      border-radius: 50%;\n      display: flex;\n      align-items: center;\n      justify-content: center;\n      box-shadow: 0 2px 10px rgba(0, 0, 0, 0.2);\n      cursor: pointer;\n      z-index: 10000;\n    }\n    \n    .floating-chat-icon svg {\n      width: 30px;\n      height: 30px;\n      fill: white;\n    }\n    \n    @keyframes fadeIn {\n      from { opacity: 0; transform: translateY(20px); }\n      to { opacity: 1; transform: translateY(0); }\n    }\n\n    .close-prompt-messages-btn {\n      position: relative;\n      background: #f9fafbAA;\n      border: none;\n      outline: none;\n      border-radius: 25px;\n      height: 32px;\n      width: 32px;\n      cursor: pointer;\n      color: #555;\n      display: flex;\n      align-items: center;\n      justify-content: center;\n    }\n  `;\n  document.head.appendChild(style);\n}\n\n// Fetch IP address and set as hidden field\nfunction setIPAddress() {\n  if (!window.fetch) return;\n\n  fetch(\"https://api.ipify.org?format=json\")\n    .then((response) => {\n      if (!response.ok) {\n        throw new Error(`HTTP error! Status: ${response.status}`);\n      }\n      return response.json();\n    })\n    .then((data) => {\n      if (data && data.ip) {\n        embeddedservice_bootstrap.prechatAPI.setHiddenPrechatFields({\n          ip_address: data.ip,\n        });\n      }\n    })\n    .catch((error) => {\n      console.warn(\"Could not retrieve IP address:\", error.message);\n    });\n}\n\n// Get UTM parameters from URL\nfunction getUTMParam(param) {\n  const urlParams = new URLSearchParams(window.location.search);\n  return urlParams.get(param) || null;\n}\n\n// Track events using Clarity if available\nfunction trackEvent(eventName) {\n  if (window.clarity) {\n    window.clarity(\"event\", eventName);\n  }\n}\n\n// Hide message prompts\nfunction hideMessages() {\n  const container = document.querySelector(\".floating-message-container\");\n  if (container) {\n    container.style.display = \"none\";\n  }\n}\n\n// Open chat and hide message prompts\nfunction openChat() {\n  const chatButton = document.querySelector(\n    \"#embeddedMessagingConversationButton\"\n  );\n  if (chatButton) {\n    chatButton.click();\n    hideMessages();\n  } else {\n    console.error(\"Chat button not found.\");\n  }\n}\n\n// Create and add a message to container\nfunction addMessage(container, message, classes) {\n  const messageElement = document.createElement(\"div\");\n  messageElement.className = `floating-message ${classes}`;\n  messageElement.textContent = message.text;\n  messageElement.id = message.id;\n\n  messageElement.addEventListener(\"click\", function () {\n    trackEvent(`Clicked_${message.id}`);\n    openChat();\n  });\n\n  container.appendChild(messageElement);\n}\n\n// Display message prompts\nfunction showMessages() {\n  // Create container if it doesn't exist\n  let container = document.querySelector(\".floating-message-container\");\n  if (!container) {\n    container = document.createElement(\"div\");\n    container.className = \"floating-message-container\";\n    document.body.appendChild(container);\n  }\n\n  // Create close button\n  const closeButton = document.createElement(\"button\");\n  closeButton.innerHTML = `<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\"><path fill=\"currentColor\" d=\"M19 6.41L17.59 5L12 10.59L6.41 5L5 6.41L10.59 12L5 17.59L6.41 19L12 13.41L17.59 19L19 17.59L13.41 12z\"/></svg>`;\n  closeButton.className = \"close-prompt-messages-btn\";\n  closeButton.onclick = (e) => {\n    e.preventDefault();\n    e.stopPropagation();\n    hideMessages();\n    trackEvent(\"Clicked_Close_Chat\");\n  };\n\n  container.appendChild(closeButton);\n\n  // Display messages with delays\n  MESSAGES.forEach((message, index) => {\n    setTimeout(() => {\n      const classes = index > 0 ? \"clickable\" : \"\";\n      addMessage(container, message, classes);\n    }, message.delay);\n  });\n}\n\n// Initialize message prompts with retry logic\nfunction initMessagePrompts(attempts = 10) {\n  // get the salesforce chat widget\n  const chatButton = document.querySelector(\n    \"#embeddedMessagingConversationButton\"\n  );\n\n  if (chatButton) {\n    showMessages();\n\n    // Add event listener to native chat button\n    chatButton.addEventListener(\"click\", function () {\n      hideMessages();\n      trackEvent(\"Clicked_Open_Chat\");\n    });\n\n    console.log(\"Chat prompts initialized successfully.\");\n  } else if (attempts > 0) {\n    console.warn(\"Chat button not found. Retrying...\");\n    setTimeout(() => initMessagePrompts(attempts - 1), 1000);\n  } else {\n    console.error(\"Failed to initialize chat prompts after multiple attempts.\");\n  }\n}\n\n// Initialize embedded messaging service\nfunction initEmbeddedMessaging() {\n  try {\n    embeddedservice_bootstrap.settings.language = \"en_US\";\n\n    // Handle ready event\n    window.addEventListener(\"onEmbeddedMessagingReady\", () => {\n      console.log(\"Embedded messaging ready\");\n\n      embeddedservice_bootstrap.prechatAPI.setHiddenPrechatFields({\n        utm_source: getUTMParam(\"utm_source\"),\n        utm_campaign: getUTMParam(\"utm_campaign\"),\n        utm_content: getUTMParam(\"utm_content\"),\n        utm_term: getUTMParam(\"utm_term\"),\n        utm_medium: getUTMParam(\"utm_medium\"),\n      });\n\n      setIPAddress();\n    });\n\n    // Initialize the embedded service\n    embeddedservice_bootstrap.init(AGENT_ID, AGENT_NAME, AGENT_URL, {\n      scrt2URL: \"https://realfast-ai--sandboxjtb.sandbox.my.salesforce-scrt.com\",\n    });\n\n    // Check if widget was previously opened\n    const widgetStorage = localStorage.getItem(`${AGENT_ID}_WEB_STORAGE`);\n    const widgetData = JSON.parse(widgetStorage || \"{}\");\n\n    // Open the message hints if the widget was never opened\n    if (!(widgetData && widgetData.CONVERSATION_BUTTON_CLICK_TIME)) {\n      setTimeout(() => initMessagePrompts(), 1000);\n    }\n\n    // Show message prompts after a delay\n  } catch (err) {\n    console.error(\"Error loading Embedded Messaging:\", err);\n  }\n}\n\n// Initialize styles to show question prompts\n(function () {\n  injectStyles();\n})();\n"],"mappings":"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","ignoreList":[]}